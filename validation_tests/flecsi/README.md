Based on tutorial code from flecsi@2.2.1
